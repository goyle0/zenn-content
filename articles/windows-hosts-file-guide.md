---
title: "【Windows】hostsファイルの場所・設定方法・反映方法まとめ"
emoji: "🌐"
type: "tech"
topics: ["windows", "network", "hosts", "dns", "beginners"]
published: true
---

## はじめに

Webアプリの開発やサーバー移行の際に、「特定のドメインを別のIPアドレスに向けたい」という場面があります。
そんなときに使うのが **hostsファイル** です。

この記事では、hostsファイルの基本から設定・反映方法までをわかりやすくまとめます。

## hostsファイルとは？

hostsファイルは、**ドメイン名とIPアドレスの対応を手動で設定できるファイル**です。

通常、ブラウザでWebサイトにアクセスすると、DNSサーバーに問い合わせてドメイン名からIPアドレスを取得します。
しかし、hostsファイルに記載があると、**DNSサーバーよりも先にhostsファイルの設定が優先**されます。

```
【通常のアクセス】
ブラウザ → DNSサーバー → IPアドレス取得 → Webサーバーへ接続

【hostsファイル設定時】
ブラウザ → hostsファイルを確認 → 記載あり → 指定のIPアドレスへ接続
                                → 記載なし → DNSサーバーへ問い合わせ
```

## hostsファイルの場所

### Windows

```
C:\Windows\System32\drivers\etc\hosts
```

エクスプローラーで上記のフォルダを開くと、`hosts` というファイルがあります。
拡張子はありません。

:::message
`hosts` ファイルが見えない場合は、エクスプローラーの表示設定で「隠しファイルを表示」をオンにしてください。
:::

### Mac / Linux（参考）

```
/etc/hosts
```

## hostsファイルの編集方法

### 手順1：メモ帳を管理者権限で開く

hostsファイルの編集には **管理者権限** が必要です。

1. Windowsの検索バーで「メモ帳」と入力
2. 「メモ帳」を **右クリック**
3. 「**管理者として実行**」を選択

:::message alert
管理者権限で開かないと、保存時に「アクセスが拒否されました」とエラーになります。
:::

### 手順2：hostsファイルを開く

1. メモ帳の「ファイル」→「開く」
2. ファイルの種類を「**すべてのファイル (\*.\*)**」に変更
3. 以下のパスに移動して `hosts` を開く

```
C:\Windows\System32\drivers\etc
```

### 手順3：設定を追加する

ファイルの末尾に、IPアドレスとドメイン名を **半角スペースまたはタブ区切り** で記載します。

```
# === ここから追加 ===
192.168.1.100    example.com
192.168.1.100    www.example.com
# === ここまで ===
```

**記載ルール：**

| 項目 | 説明 |
|------|------|
| IPアドレス | 接続先のIPアドレス（半角） |
| 区切り | 半角スペースまたはタブ |
| ドメイン名 | 対象のドメイン名（半角） |
| コメント | `#` で始まる行はコメント（メモ用） |

### 設定の記載例

```
# ローカル開発環境への向き先変更
127.0.0.1    myapp.local

# ステージング環境での確認
10.0.0.50    staging.example.com

# 特定のサイトへのアクセスをブロック（自分自身に向ける）
127.0.0.1    block-this-site.com
```

### 手順4：保存する

「ファイル」→「上書き保存」（Ctrl + S）で保存します。

:::message
保存時に文字コードを聞かれた場合は、**UTF-8** を選択してください。
:::

## 設定を反映する方法

hostsファイルを保存しただけでは、すぐに反映されない場合があります。
**DNSキャッシュのクリア**を行うことで確実に反映できます。

### DNSキャッシュのクリア手順

1. コマンドプロンプトまたはPowerShellを開く（管理者権限推奨）
2. 以下のコマンドを実行

```bash
ipconfig /flushdns
```

3. 「DNSリゾルバー キャッシュは正常にフラッシュされました。」と表示されれば完了

### ブラウザのキャッシュもクリアする

ブラウザ側にもDNSキャッシュが残っている場合があります。

**Chromeの場合：**

1. アドレスバーに `chrome://net-internals/#dns` と入力
2. 「**Clear host cache**」ボタンをクリック

**簡易的な方法：**

ブラウザを一度完全に閉じて、再度開き直す。

## 設定が反映されたか確認する方法

### 方法1：pingコマンドで確認

```bash
ping example.com
```

表示されるIPアドレスが、hostsファイルに記載したものと一致していればOKです。

```
example.com [192.168.1.100]に ping を送信しています...
```

### 方法2：nslookupとの比較

```bash
nslookup example.com
```

`nslookup` はhostsファイルを**参照しない**ため、DNSサーバーの応答が返ります。
`ping` の結果と `nslookup` の結果が異なれば、hostsファイルの設定が効いている証拠です。

## よくある使いどころ

### 1. サーバー移行前の動作確認

新サーバーにWebサイトを移行する際、DNS切り替え前に新サーバーでの動作を確認したい場合に使います。

```
# 新サーバーのIPで動作確認
203.0.113.10    www.example.com
```

### 2. ローカル開発環境への名前解決

開発中のアプリケーションにドメイン名でアクセスしたい場合に使います。

```
# ローカル開発用
127.0.0.1    myapp.local
127.0.0.1    api.myapp.local
```

### 3. 特定サイトへのアクセスブロック

自分自身（127.0.0.1）に向けることで、特定サイトへのアクセスをブロックできます。

```
# アクセスをブロック
127.0.0.1    block-target.com
```

## 注意点

:::message alert
**作業が終わったら、追加した行を削除またはコメントアウトすることを忘れずに！**
hostsファイルの設定を残したままにすると、意図しない接続先に繋がり続けてしまいます。
:::

- hostsファイルの編集には**管理者権限**が必要です
- 記載ミス（全角スペースの混入など）があると正しく動作しません
- 設定は**そのPC限定**で有効です（他のPCには影響しません）
- セキュリティソフトによっては、hostsファイルの変更を検知・ブロックする場合があります

## まとめ

| 項目 | 内容 |
|------|------|
| ファイルの場所 | `C:\Windows\System32\drivers\etc\hosts` |
| 編集方法 | メモ帳を管理者権限で開いて編集 |
| 記載形式 | `IPアドレス（半角スペース）ドメイン名` |
| 反映方法 | `ipconfig /flushdns` でDNSキャッシュクリア |
| 確認方法 | `ping ドメイン名` でIPアドレスを確認 |

hostsファイルはシンプルですが、開発やインフラ作業で非常に便利なツールです。
基本を押さえておくと、いざというときにすぐ活用できます。
